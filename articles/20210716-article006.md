---
title: "React Hooksã®10ç¨®é¡ã‚’ç†è§£ã™ã‚‹ï¼ˆAdditional: useMemo, useCallbackï¼‰"
emoji: "ğŸ˜…"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["react", "react hooks"]
published: true
---

# React Hooksã®10ç¨®é¡ã‚’ç†è§£ã™ã‚‹ï¼ˆBasic: useMemo, useCallbackï¼‰
## ãã‚‚ãã‚‚memoã¨ã¯ï¼ˆmemoizationï¼‰

> Memoization is an optimization technique that speeds up applications by storing the results of expensive function calls and returning the cached result when the same inputs are supplied again.

> ã€Œãƒ¡ãƒ¢åŒ–ã€ã¨ã¯ã€é«˜éšé–¢æ•°ã®å‘¼ã³å‡ºã—çµæœã‚’è²¯ã‚ã‚‹ï¼ˆstoreï¼‰ã“ã¨ã‚’ã—ãŸã‚Šã€åŒã˜å€¤ãŒå†åº¦å…¥åŠ›ã•ã‚ŒãŸã¨ãã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸçµæœã‚’è¿”ã—ãŸã‚Šã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ã‚¢ãƒ—ãƒªã®ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚’ä¸Šã’ã‚‹æœ€é©åŒ–æŠ€è¡“ã§ã‚ã‚‹ã€‚

- ä¸Šè¨˜ã®é€šã‚Šã€ã€Œãƒ¡ãƒ¢åŒ–ã€ã¯ä¸€åº¦è¨ˆç®—ã•ã‚ŒãŸå€¤ã‚’ä¿å­˜ã—ã¦å†åˆ©ç”¨ã™ã‚‹ãŸã‚ã®æŠ€è¡“ã§ã‚ã‚‹ã€‚

## plain javascript

- æ™®é€šã®Javascriptã§ã“ã®ã€Œãƒ¡ãƒ¢åŒ–ã€ã‚’å†ç¾ã™ã‚‹ã¨ã€ä¾‹ãˆã°ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚‹ã€‚

```javascript
const memoFunc = (n: number) => {
  const cache = []; // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ ¼ç´ã™ã‚‹å ´æ‰€

  const func = (n: number) => {
    if (n in cache) {
      return cache[n];
    }

    if (n < 2n) {
      return n;
    }

    return cache[n] = func(n - 1n) + func(n - 2n);
  }

  return func(n);
}
```

ã“ã®è¨ˆç®—çµæœã¯ã€ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚‹ã€‚

```javascript
func(5): func(4) + func(3)
func(4): func(3) + func(2)
func(3): func(2) + func(1)
func(2): func(1) + func(0)
```

å¤‰æ•°`cache`ã‚’å®£è¨€ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ã“ã“ã«è¨ˆç®—çµæœã‚’storeã—ã¦ã„ãã€‚

## Reactã«ãŠã‘ã‚‹`useMemo`ã¨`useCallback`ã¨ã®é•ã„

- Reactã«ãŠã‘ã‚‹ãƒ¡ãƒ¢åŒ–ã¯2ç¨®é¡ã‚ã‚Šã€`useMemo`ã¯å€¤ã‚’è¿”ã™ã€‚`useCallback`ã¯é–¢æ•°ã‚’è¿”ã™ã€‚

```javascript
<!-- åŸºæœ¬æ§‹æ–‡ -->
const memo = useMemo(() => fn, deps);
const callback = useCallback(fn, deps);
```

```javascript
const memoizedValue = useMemo(
  () => computeExpensiveValue(a, b), [a, b]
);

const memoizedCallback = useCallback(
  () => {
    doSomething(a, b);
  },
  [a, b],
);
```

## `useMemo`

- `useMemo`ã¯å¼•æ•°ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã®ã¿å†è¨ˆç®—ã‚’è¡Œã†ã€‚
- `useMemo`ã«æ¸¡ã—ãŸé–¢æ•°ã¯ãƒ¬ãƒ³ãƒ€ãƒ¼ä¸­ã«å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€ãƒ¬ãƒ³ãƒ€ãƒ¼ä¸­ã«é€šå¸¸ã‚„ã‚‰ãªã„ã‚ˆã†ãªé–¢æ•°ã‚’å…¥ã‚Œãšã€ä¾‹ãˆã°`useEffect`ãªã©ã«å…¥ã‚Œã‚‹ã®ãŒè‰¯ã„ã€‚
  
## `useCallback`

- `useCallback`ã¯å‡¦ç†ã‚’ãƒ¡ãƒ¢åŒ–ã§ãã‚‹ã€‚
- `useEffect`å†…ã§åº¦ã€…ä½¿ç”¨ã•ã‚Œã‚‹å‡¦ç†ã¯`useCallback`ã«è¨˜è¼‰ã—ã¦ãƒ¡ãƒ¢åŒ–ã—ã¦ãŠãã®ãŒè‰¯ã„ã€‚

## reference

- [ãƒ•ãƒƒã‚¯ API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](https://ja.reactjs.org/docs/hooks-reference.html)
- [ã™ã”ã„Reactãƒ•ãƒƒã‚¯8é¸](https://qiita.com/baby-degu/items/52dbb382bbaf6c43e2db)
- [Memoization](https://en.wikipedia.org/wiki/Memoization)
- [Introduction to memoization in JavaScript](https://medium.com/dailyjs/introduction-to-memoization-in-javascript-6125fa05a558)

